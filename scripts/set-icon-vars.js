const fs = require('node:fs');
const feather = require('feather-icons');

/**
 * Convert feather icons to base64 encoded SVGs
 * and write to src/icons.scss
 */

function setFeatherSCSSvars() {

    const iconVarsFile = `${process.cwd()}/src/icons.scss`;
    let content = fs.readFileSync(iconVarsFile, 'utf8');

    const icons = Object.values(feather.icons).map(icon => ({
        label: icon.name,
        icon: icon.toSvg()
    }));

    let newContent = `// !!!\n// Do not edit this file directly.\n// These values are updated on theme build.\n$icon_content: (\n`;
    icons.forEach(icon => {
        newContent += `'${icon.label}': 'data:image/svg+xml;utf8,${icon.icon}',\n`;
    });
    newContent += `);\n// !!!\n`;

    fs.writeFileSync(iconVarsFile, newContent);
}

setFeatherSCSSvars();